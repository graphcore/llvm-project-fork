# RUN: llc -march=colossus -run-pass=colossus-and-elim -x=mir -o - < %s | FileCheck %s

# AND_ZI cannot be removed because the BRZ instruction in bb.1 kills $m0 despite
# an occurrance of $m1 beyond the BRZ instruction.

# CHECK: $m0 = LDZ8_ZI killed $m0, $mzero, 0, 0
# CHECK: $m1 = AND_ZI killed $m0, 255, 0
# CHECK: $m0 = COPY killed $m1

---
name:            foo
tracksRegLiveness: false
machineFunctionInfo: {}
body:             |
  bb.0.entry:
    $m0 = LDZ8_ZI killed $m0, $mzero, 0, 0
    BR %bb.1, 0
  
  bb.1:
    $m1 = AND_ZI killed $m0, 255, 0
    BRZ killed $m0, %bb.2, 0
    BR %bb.3, 0
  
  bb.2:
    $m0 = COPY killed $m1
    RTN $lr, 0
  
  bb.3:
    $m0 = SETZI 625351, 0
    $m0 = OR_IZ killed $m0, 10485760, 0
    RTN $lr, 0

...
